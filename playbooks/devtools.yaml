- name: Setup DevTools instance. Install Java8, Maven, Git, Jenkins, Ansible and Nexus tools
  hosts: tag_Name_DevTools #devtools
  roles:
    # make swap file; t2:micro has not enough memory for running maven build; "out of memory" error     
     - { role: geerlingguy.swap, swap_file_size_mb: 3072 }
    # insall Java 8
     - { role: java8 } #this role installs java-1.8.0
    # install Sonatype Nexus Repository and configure initial password
     - { role: sansible.nexus, sansible_nexus_configuration_admin_password: initpassword }
    # install Maven 3.6.2
     - { role: tecris.maven, maven_major: 3, maven_version: 3.6.2, maven_home_parent_directory: /opt }
    # install the EPEL repository (Extra Packages for Enterprise Linux) for RHEL/CentOS. To install Ansible
     - { role: geerlingguy.repo-epel, centos_version: 7 } #this role enables EPEL repository, so we can install Ansible with "yum install"
  become: true
  tasks:

    - name: Install Ansible from epel-repository
      yum:
        name: ansible
        update_cache: yes
        state: present

    - name: Install Git from Amazon or CentOS repos
      yum:
        name: git
        update_cache: yes
        state: present

    - name: Ensure Jenkins Repository is Installed
      yum_repository:
        name: jenkins
        state: present
        description: Official Jenkins Yum Repo
        baseurl: http://pkg.jenkins.io/redhat-stable
        gpgkey: https://jenkins-ci.org/redhat/jenkins-ci.org.key
        gpgcheck: yes
        enabled: yes

    - name: install Jenkins from Jenkins repos
      yum:
        name: jenkins
        update_cache: yes
        state: present

    - name: Enable and Start the Jenkins Service
      service:
        name: jenkins
        enabled: yes
        state: started
